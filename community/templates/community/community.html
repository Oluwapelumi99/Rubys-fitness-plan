{% extends "base.html" %}
{% load static %}
{% load crispy_forms_tags %}
{% block content %}

<div class="masthead">
    <div class="container text-center">
        <div class="row g-0">
            <div class="col-md-6 masthead-text">
                <h1 class="blog-title float-left">{{ blog.title }}</h1>
                <p class="blog-subtitle ">{{ blog.author }} | {{ blog.created_on }}</p>
                {% if blog.image %}
                <img class="card-img-top mt-3 float-left glutes-container" src="{{ blog.image.url }}" alt="{{ blog.name }}" >    
                {% else %}
                <img class="card-img-top img-fluid" src="{{ MEDIA_URL }}noimage.png" alt="{{ blog.name }}">
                {% endif %}
            </div>
        </div>
    </div>
    <div class="container">
        <div class="row">
            <div class="col mb-4  mt-3 left top">
                <div class="card-body shadow">
                    <p class="card-text">
                        {{ blog.content | safe }}
                    </p>
                </div>
            </div>
        </div>
    </div>
    <div class="container">
      <div class="row">
        <div class="col-12">
          <strong class="text-secondary">
            <i class="far fa-comments"></i> {{ comment_count }}
          </strong>
        </div>
        <div class="col-12">
          <hr>
        </div>
      </div>
    </div>
    {% for comment in comments %}
      {{ comment.author }}
      {{ comment.created_on }}
      {{ comment.body }}
          {% for reply in comment.replies.all %}
            {{ reply.author }}
            {{ reply.created_on }}
            {{ reply.body }}
          {% endfor %}
          <a class="text-decoration-none" data-toggle="collapse" href="#collapseExample{{comment.id}}" role="button" aria-expanded="false" aria-controls="collapseExample">
            Reply</a>
            <div class="collapse" id="collapseExample{{comment.id}}">
              <div>
                <form action="" method="POST" enctype="'multipart/comment_form-data">
                  {% csrf_token %}
                  <div class="form-group">
                    {{ comment_form.author }}
                  </div>
                  <div class="form-group mt-md-2">
                    <!-- {{ comment_form.comment | crispy }} -->
                    {{ comment_form | crispy }}
                    {% csrf_token %}
                  </div>
                  <input type="hidden" name="reply_id" value="{{ comment_id }}">
                  <button class="btn btn-primary mt-md-1" type="submit" value="Reply">Reply</button>
                </form>
              </div>
            </div>
    {% endfor %}
  </div>
</div>

{% endblock %}